<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ECtiers</title>
<style>
body { margin:0; font-family:sans-serif; background:#0b0c0f; color:#e6eef8; }
header { display:flex; justify-content:space-between; align-items:center; padding:12px 20px; background:#070708; border-bottom:1px solid rgba(255,255,255,0.03);}
.brand { font-weight:700; font-size:22px; }
.navtabs { display:flex; gap:6px; flex-wrap:wrap; }
.tab { padding:6px 12px; background:transparent; border-radius:8px; border:none; cursor:pointer; color:#98a2b3;}
.tab.active { background:rgba(255,255,255,0.03); color:#6ea0ff;}
.main { display:grid; grid-template-columns:1fr 280px; gap:12px; padding:16px; }
.panel { background:#0f1114; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); }
.controls input, .controls select { width:100%; margin-bottom:8px; padding:8px; border-radius:6px; border:1px solid rgba(255,255,255,0.03); background:transparent; color:inherit;}
.controls button { padding:8px 12px; border-radius:8px; border:none; cursor:pointer; background:#3a7afe; color:white; margin-right:6px;}
.board { display:grid; gap:12px; }
.card { background:rgba(255,255,255,0.01); padding:12px; border-radius:12px; }
.card h3 { margin:0 0 8px 0; }
.player-entry { display:flex; justify-content:space-between; padding:6px 8px; border-radius:6px; background:rgba(255,255,255,0.02); margin-bottom:4px; font-size:14px;}
.leaderboard h3 { margin-top:0; margin-bottom:8px; font-size:18px; }
.lb-item { display:flex; justify-content:space-between; padding:6px 8px; border-radius:6px; background:rgba(255,255,255,0.02); margin-bottom:4px; font-size:14px; }
.modal { position:fixed; inset:0; background:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center;}
.modal-card { background:#0f1114; padding:16px; border-radius:12px; width:320px; border:1px solid rgba(255,255,255,0.03);}
.hide { display:none;}
</style>
</head>
<body>

<header>
  <div class="brand">MC-Tiers Tierlist</div>
  <div class="navtabs" id="gamemode-tabs"></div>
  <div>
    <span id="who">Not logged in</span>
    <button id="btn-login">Log in</button>
    <button id="btn-logout" class="hide">Log out</button>
  </div>
</header>

<main class="main">
  <div class="board" id="board"></div>
  <div class="panel leaderboard">
    <h3>Overall Leaderboard</h3>
    <div id="leaderboard"></div>
  </div>
</main>

<div class="modal" id="modal">
  <div class="modal-card">
    <h2>Log in</h2>
    <input id="login-user" placeholder="Username">
    <input id="login-pass" type="password" placeholder="Password">
    <div>
      <button id="login-ok">Log in</button>
      <button id="login-cancel">Cancel</button>
    </div>
    <p style="font-size:13px; color:#98a2b3;">Demo accounts: <strong>admin / adminpass</strong>, <strong>owner / ownerpass</strong></p>
  </div>
</div>

<script>
const TIER_POINTS = { lt5:10, ht5:20, lt4:30, ht4:40, lt3:50, ht3:60, lt2:70, ht2:80, lt1:90, ht1:100 };
const GAMEMODES = ["crystal","sword","axe","uhc","netherite_pot","diamond_pot","mace","smp","diamond_smp"];
const ACCOUNTS = { owner:{username:"owner",password:"ownerpass",role:"owner"}, admin:{username:"admin",password:"adminpass",role:"admin"} };
let players = {};
let session = null;
let currentView = "overall";

const board = document.getElementById("board");
const leaderboard = document.getElementById("leaderboard");
const who = document.getElementById("who");
const modal = document.getElementById("modal");

// --- Setup gamemode tabs ---
const gmTabs = document.getElementById("gamemode-tabs");
const tabs = [];
const overallBtn = document.createElement("button");
overallBtn.textContent="Overall";
overallBtn.className="tab active";
overallBtn.onclick=()=>{currentView="overall"; setActiveTab(overallBtn); renderBoard();}
gmTabs.appendChild(overallBtn); tabs.push(overallBtn);

GAMEMODES.forEach(gm=>{
  const btn=document.createElement("button");
  btn.textContent=gm.replace("_"," ");
  btn.className="tab";
  btn.onclick=()=>{currentView=gm; setActiveTab(btn); renderBoard();}
  gmTabs.appendChild(btn); tabs.push(btn);
});
function setActiveTab(active){ tabs.forEach(t=>t.classList.remove("active")); active.classList.add("active"); }

// --- Login logic ---
document.getElementById("btn-login").onclick = ()=> modal.classList.remove("hide");
document.getElementById("login-cancel").onclick = ()=> modal.classList.add("hide");
document.getElementById("login-ok").onclick = ()=>{
  const u=document.getElementById("login-user").value.trim();
  const p=document.getElementById("login-pass").value;
  for(const k in ACCOUNTS){ const a=ACCOUNTS[k]; if(a.username===u && a.password===p){ session=a; modal.classList.add("hide"); who.textContent=a.username+" • "+a.role; renderBoard(); return; } }
  alert("Invalid login");
};
document.getElementById("btn-logout").onclick = ()=>{ session=null; who.textContent="Not logged in"; renderBoard(); };

// --- Tierlist functions ---
function addTier(player, gm, tier){
  if(!players[player]) players[player]={};
  if(!players[player][gm]) players[player][gm]=[];
  players[player][gm].push(tier);
  renderBoard(); renderLeaderboard();
}

function renderBoard(){
  board.innerHTML="";
  if(currentView==="overall"){
    GAMEMODES.forEach(gm=>{
      const card=document.createElement("div"); card.className="card";
      const h3=document.createElement("h3"); h3.textContent=gm.replace("_"," "); card.appendChild(h3);
      const arr=[];
      for(const p in players){
        const pts=(players[p][gm]||[]).reduce((s,t)=>s+TIER_POINTS[t],0);
        if(pts>0) arr.push({name:p,pts,tiers:players[p][gm]});
      }
      arr.sort((a,b)=>b.pts-a.pts);
      arr.forEach((p,i)=>{
        const pe=document.createElement("div"); pe.className="player-entry"; 
        pe.textContent=(i+1)+". "+p.name+" → "+p.pts+" ("+p.tiers.join(", ")+")";
        if(session && session.role==="admin"){
          const btn=document.createElement("button"); btn.textContent="Add Tier"; btn.onclick=()=>{ const t=prompt("Tier (lt5, ht5, ...):"); if(TIER_POINTS[t]){ addTier(p.name, gm, t);} }; pe.appendChild(btn);
        }
        card.appendChild(pe);
      });
      if(arr.length===0){ const pe=document.createElement("div"); pe.className="player-entry"; pe.textContent="No entries"; card.appendChild(pe);}
      board.appendChild(card);
    });
  } else {
    const gm=currentView;
    const card=document.createElement("div"); card.className="card";
    const h3=document.createElement("h3"); h3.textContent=gm.replace("_"," "); card.appendChild(h3);
    const arr=[];
    for(const p in players){
      const tiers=players[p][gm]||[];
      const pts=tiers.reduce((s,t)=>s+TIER_POINTS[t],0);
      if(tiers.length>0) arr.push({name:p,tiers,pts});
    }
    arr.sort((a,b)=>b.pts-a.pts);
    arr.forEach((p,i)=>{
      const pe=document.createElement("div"); pe.className="player-entry";
      pe.textContent=(i+1)+". "+p.name+" → "+p.pts+" ("+p.tiers.join(", ")+")";
      if(session && session.role==="admin"){
        const btn=document.createElement("button"); btn.textContent="Add Tier"; btn.onclick=()=>{ const t=prompt("Tier (lt5, ht5, ...):"); if(TIER_POINTS[t]){ addTier(p.name, gm, t);} }; pe.appendChild(btn);
      }
      card.appendChild(pe);
    });
    if(arr.length===0){ const pe=document.createElement("div"); pe.className="player-entry"; pe.textContent="No entries"; card.appendChild(pe);}
    board.appendChild(card);
  }
}

function renderLeaderboard(){
  leaderboard.innerHTML="";
  const arr=[];
  for(const p in players){
    let total=0;
    GAMEMODES.forEach(gm=>{ total+= (players[p][gm]||[]).reduce((s,t)=>s+TIER_POINTS[t],0); });
    arr.push({name:p,total});
  }
  arr.sort((a,b)=>b.total-a.total);
  arr.forEach((p,i)=>{
    const el=document.createElement("div"); el.className="lb-item"; el.textContent=(i+1)+". "+p.name+" → "+p.total;
    leaderboard.appendChild(el);
  });
}

// --- Demo data ---
addTier("SussyTech","crystal","ht1");
addTier("SussyTech","uhc","lt3");
addTier("GamerX","diamond_pot","ht2");

renderBoard(); renderLeaderboard();
</script>

</body>
</html>
