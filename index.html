<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ECtiers</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: white;
}

/* ---- NAV ---- */
nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #111;
    padding: 10px 20px;
    border-bottom: 2px solid #333;
}
.nav-left, .nav-right {
    display: flex;
    gap: 15px;
}
nav a {
    color: white;
    text-decoration: none;
    font-size: 16px;
}
nav a:hover {
    text-decoration: underline;
}

#searchBar {
    padding: 5px 10px;
    border-radius: 5px;
    border: none;
}

/* ---- PAGES ---- */
.page {
    display: none;
    padding: 20px;
}
.active {
    display: block;
}

/* ---- TIER COLORS ---- */
.tier-header {
    font-size: 32px;
    margin-top: 30px;
    margin-bottom: 10px;
    font-weight: bold;
}

.tier1 { color: gold; }
.tier2 { color: silver; }
.tier3 { color: #7CFC00; }
.tier4 { color: #00CC66; }
.tier5 { color: gray; }

.tier-box {
    padding-left: 20px;
    font-size: 18px;
}

/* ---- PLAYER LIST ---- */
.player {
    cursor: pointer;
    padding: 5px 0;
}
.player:hover {
    text-decoration: underline;
}

/* ---- OVERALL TAB ---- */
#overallPage {
    height: calc(100vh - 80px);
    overflow-y: auto;
}

.overall-card {
    background: #2b2b2b;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 10px;
}

.overall-name {
    font-size: 22px;
    font-weight: bold;
}

.overall-points {
    font-size: 16px;
    margin-bottom: 10px;
}

/* ---- LOGIN ---- */
#loginPage, #registerPage {
    max-width: 350px;
    margin: 50px auto;
    background: #222;
    padding: 20px;
    border-radius: 10px;
}

input {
    width: 100%;
    padding: 8px;
    margin: 7px 0;
    border-radius: 5px;
    border: none;
}

button {
    width: 100%;
    padding: 10px;
    background: #444;
    border: none;
    color: white;
    font-size: 16px;
    border-radius: 5px;
}
button:hover { background: #666; }

/* ---- POPUP ---- */
#playerPopup {
    position: fixed;
    top: 50%;
    left: 50%;
    width: 350px;
    transform: translate(-50%, -50%);
    background: #111;
    padding: 20px;
    border-radius: 10px;
    display: none;
}
#popupClose {
    text-align: right;
    cursor: pointer;
    font-size: 20px;
    margin-bottom: 10px;
}

/* ---- ADMIN PANEL ---- */
#adminPage {
    max-width: 600px;
}
select, input {
    margin: 5px 0;
}

</style>
</head>
<body>

<!-- NAVIGATION -->
<nav>
    <div class="nav-left">
        <a href="#" onclick="openPage('overallPage')">Overall</a>
        <a href="#" onclick="openPage('axePage')">Axe</a>
        <a href="#" onclick="openPage('swordPage')">Sword</a>
        <a href="#" onclick="openPage('crystalPage')">Crystal</a>
        <a href="#" onclick="openPage('netheritePage')">Netherite Pot</a>
        <a href="#" onclick="openPage('diamondpotPage')">Diamond Pot</a>
        <a href="#" onclick="openPage('macePage')">Mace</a>
        <a href="#" onclick="openPage('smpPage')">SMP</a>
        <a href="#" onclick="openPage('dsmpPage')">Diamond SMP</a>
        <a href="#" onclick="openPage('uhcPage')">UHC</a>
    </div>

    <div class="nav-right">
        <input id="searchBar" placeholder="Search player..." oninput="searchPlayer()">
        <a href="#" onclick="openPage('adminPage')" id="adminBtn" style="display:none">Admin</a>
    </div>
</nav>

<!-- LOGIN PAGE -->
<div class="page active" id="loginPage">
    <h2>Login</h2>
    <input id="loginUser" placeholder="Username">
    <input id="loginPass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <br><br>
    <a onclick="openPage('registerPage')" style="cursor:pointer">Register</a>
</div>

<!-- REGISTER PAGE -->
<div class="page" id="registerPage">
    <h2>Register</h2>
    <input id="regUser" placeholder="Username">
    <input id="regPass" type="password" placeholder="Password">
    <button onclick="register()">Register</button>
    <br><br>
    <a onclick="openPage('loginPage')" style="cursor:pointer">Back to Login</a>
</div>

<!-- OVERALL -->
<div class="page" id="overallPage"></div>

<!-- GAMEMODE PAGES -->
<div class="page" id="axePage"></div>
<div class="page" id="swordPage"></div>
<div class="page" id="crystalPage"></div>
<div class="page" id="netheritePage"></div>
<div class="page" id="diamondpotPage"></div>
<div class="page" id="macePage"></div>
<div class="page" id="smpPage"></div>
<div class="page" id="dsmpPage"></div>
<div class="page" id="uhcPage"></div>

<!-- ADMIN PANEL -->
<div class="page" id="adminPage">
    <h2>Admin Panel</h2>

    <h3>Assign / Remove Tier</h3>
    <input id="admPlayer" placeholder="Player IGN">
    <select id="admMode">
        <option>Axe</option><option>Sword</option><option>Crystal</option>
        <option>Netherite</option><option>Diamond Pot</option>
        <option>Mace</option><option>SMP</option><option>Diamond SMP</option><option>UHC</option>
    </select>
    <select id="admTier">
        <option>None</option>
        <option>HT1</option><option>LT1</option>
        <option>HT2</option><option>LT2</option>
        <option>HT3</option><option>LT3</option>
        <option>HT4</option><option>LT4</option>
        <option>HT5</option><option>LT5</option>
    </select>
    <button onclick="setTier()">Apply</button>

    <h3>Set Player Role</h3>
    <input id="admUserRole" placeholder="Username">
    <select id="admRole">
        <option>player</option>
        <option>admin</option>
    </select>
    <button onclick="setRole()">Set Role</button>
</div>

<!-- POPUP -->
<div id="playerPopup">
    <div id="popupClose" onclick="closePopup()">✖</div>
    <div id="popupContent"></div>
</div>

<script>
/* ------------------------------
   LOCAL STORAGE STRUCTURE
--------------------------------*/
if (!localStorage.users) {
    localStorage.users = JSON.stringify({
        "sussytech": {
            pass: "Sussybaka1!2@3#4$",
            role: "owner",
            tiers: {}
        }
    });
}

let currentUser = null;

const modes = [
    "Axe","Sword","Crystal","Netherite",
    "Diamond Pot","Mace","SMP","Diamond SMP","UHC"
];

/* ------------------------------
   PAGE NAVIGATION
--------------------------------*/
function openPage(id) {
    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    document.getElementById(id).classList.add("active");

    if (id === "overallPage") renderOverall();
    if (id.endsWith("Page") && id !== "overallPage" && id !== "loginPage") {
        let m = id.replace("Page","");
        renderGamemode(m);
    }
}

/* ------------------------------
   LOGIN / REGISTER
--------------------------------*/
function login() {
    let u = loginUser.value.trim();
    let p = loginPass.value;

    let db = JSON.parse(localStorage.users);

    if (db[u] && db[u].pass === p) {
        currentUser = u;
        openPage("overallPage");

        if (db[u].role === "admin" || db[u].role === "owner") {
            adminBtn.style.display = "block";
        }
    } else alert("Invalid login");
}

function register() {
    let u = regUser.value.trim();
    let p = regPass.value;

    let db = JSON.parse(localStorage.users);

    if (db[u]) return alert("User exists");

    db[u] = { pass: p, role: "player", tiers: {} };
    localStorage.users = JSON.stringify(db);

    alert("Registered!");
    openPage("loginPage");
}

/* ------------------------------
   ADMIN ROLE SET
--------------------------------*/
function setRole() {
    let u = admUserRole.value.trim();
    let role = admRole.value;

    let db = JSON.parse(localStorage.users);
    if (!db[u]) return alert("User not found");

    db[u].role = role;
    localStorage.users = JSON.stringify(db);

    alert("Role updated!");
}

/* ------------------------------
   SET / REMOVE TIERS
--------------------------------*/
function setTier() {
    let name = admPlayer.value.trim();
    let mode = admMode.value;
    let tier = admTier.value;

    let db = JSON.parse(localStorage.users);
    if (!db[name]) return alert("Player not registered");

    if (tier === "None") delete db[name].tiers[mode];
    else db[name].tiers[mode] = tier;

    localStorage.users = JSON.stringify(db);
    alert("Tier updated!");
}

/* ------------------------------
   POINT SYSTEM
--------------------------------*/
function tierPoints(t) {
    return {
        "LT5":10,"HT5":20,
        "LT4":30,"HT4":40,
        "LT3":50,"HT3":60,
        "LT2":70,"HT2":80,
        "LT1":90,"HT1":100
    }[t] || 0;
}

/* ------------------------------
   COMBAT RANKS
--------------------------------*/
function combatRank(points) {
    if (points >= 660) return "Combat Grandmaster";
    if (points >= 600) return "Combat Master";
    if (points >= 460) return "Combat Ace";
    if (points >= 250) return "Combat Sigma";
    if (points >= 160) return "Combat Cleace";
    if (points >= 110) return "Combat Superb";
    if (points >= 60) return "Combat Fierce";
    if (points >= 10) return "Combat Player";
    return "Unranked";
}

/* ------------------------------
   RENDER OVERALL
--------------------------------*/
function renderOverall() {
    let out = "";
    let db = JSON.parse(localStorage.users);

    let players = Object.keys(db).map(name => {
        let pts = 0;
        for (let m of modes)
            pts += tierPoints(db[name].tiers[m]);
        return {name, pts, tiers: db[name].tiers};
    });

    players.sort((a,b)=>b.pts - a.pts);

    players.forEach(p => {
        out += `
        <div class="overall-card">
            <div class="overall-name">${p.name}</div>
            <div class="overall-points">${p.pts} points – ${combatRank(p.pts)}</div>
            <div>
                ${modes.map(m=>`${m}: ${p.tiers[m]||"None"}`).join("<br>")}
            </div>
        </div>`;
    });

    overallPage.innerHTML = out;
}

/* ------------------------------
   RENDER GAMEMODE PAGES
--------------------------------*/
function renderGamemode(mode) {
    let db = JSON.parse(localStorage.users);

    let groups = {
        HT1:[],LT1:[],HT2:[],LT2:[],
        HT3:[],LT3:[],HT4:[],LT4:[],
        HT5:[],LT5:[]
    };

    for (let name in db) {
        let t = db[name].tiers[mode];
        if (groups[t]) groups[t].push(name);
    }

    let out = `
    <div class="tier-header tier1">TIER 1</div>
    <div class="tier-box">
        <div class="player" onclick="openPlayer('${groups.HT1}')">HT1: ${groups.HT1.join(", ")}</div>
        <div class="player" onclick="openPlayer('${groups.LT1}')">LT1: ${groups.LT1.join(", ")}</div>
    </div>

    <div class="tier-header tier2">TIER 2</div>
    <div class="tier-box">
        HT2: ${groups.HT2.join(", ")}<br>
        LT2: ${groups.LT2.join(", ")}
    </div>

    <div class="tier-header tier3">TIER 3</div>
    <div class="tier-box">
        HT3: ${groups.HT3.join(", ")}<br>
        LT3: ${groups.LT3.join(", ")}
    </div>

    <div class="tier-header tier4">TIER 4</div>
    <div class="tier-box">
        HT4: ${groups.HT4.join(", ")}<br>
        LT4: ${groups.LT4.join(", ")}
    </div>

    <div class="tier-header tier5">TIER 5</div>
    <div class="tier-box">
        HT5: ${groups.HT5.join(", ")}<br>
        LT5: ${groups.LT5.join(", ")}
    </div>
    `;

    document.getElementById(mode.toLowerCase()+"Page").innerHTML = out;
}

/* ------------------------------
   PLAYER POPUP
--------------------------------*/
function openPlayer(name) {
    if (!name) return;

    let n = name.split(",")[0].trim();
    let db = JSON.parse(localStorage.users);

    if (!db[n]) return;

    let t = db[n].tiers;
    let out = `<h2>${n}</h2>`;

    modes.forEach(m=>{
        out += `<b>${m}:</b> ${t[m]||"None"}<br>`;
    });

    popupContent.innerHTML = out;
    playerPopup.style.display = "block";
}
function closePopup() {
    playerPopup.style.display = "none";
}

/* ------------------------------
   SEARCH
--------------------------------*/
function searchPlayer() {
    let q = searchBar.value.toLowerCase();
    if (!q) return renderOverall();

    let db = JSON.parse(localStorage.users);
    let out = "";

    for (let name in db) {
        if (name.toLowerCase().includes(q)) {
            let pts = 0;
            for (let m of modes) pts += tierPoints(db[name].tiers[m]);
            out += `
                <div class="overall-card">
                    <div class="overall-name">${name}</div>
                    <div class="overall-points">${pts} points – ${combatRank(pts)}</div>
                </div>`;
        }
    }

    overallPage.innerHTML = out;
}

</script>
</body>
</html>
